# 智能书籍标准 1.0

智能书籍标准（*SBS*） 1.0 是智能学习平台（*SLP*）开发使用并开源的新一代数字书籍格式标准，该标准遵循开放、易于扩展和面向智能化未来的设计理念，充分利用现有技术标准，最大限度满足各种不同应用场景的需要。

## 基本结构

本标准定义的“书”是一个自解释的目录，里面包含书的四个组成部分：**元数据**、**目录结构定义**、**正文文件**和**附加资源文件**。

### 元数据和目录结构定义

元数据和目录结构定义置于根目录下的 `toc.yaml` 文件内，遵循 [YAML](https://yaml.org/) 文件格式标准。

下面是 `toc.yaml` 文件的内容结构：

```yaml
book_name: "编程思维与实践"
book_author: "DL4ALL"
book_introduction: "为零基础人士准备的编程思维与实践入门教材"

chapters:
  - name: "第一章 基础篇"
    sections:
      - name: "理解编程语言"
        path: 01/01.md
      - name: "程序的基本结构"
        path: 01/02.md
      - name: "理解对象与类"
        path: 01/03.md
  - name: "第二章 进阶篇"
    sections:
      - name: "函数定义再探"
        path: 02/01.md
      - name: "程序中的模块与文档"
        path: 02/02.md
      - name: "数据容器"
        path: 02/03.md
...
```

其中：

- `book_name`：书名，必须字段
- `book_author`：作者名，可选字段，如无则会将创建本书的用户视为作者
- `book_introduction`：简要介绍，可选字段，目前只支持纯文本
- `chapters`：书的目录结构
  - 分为 `chapter` 和 `section` 两级，对应书的前两级章节结构
  - 每个 `section` 对应一个 `.md` 文件
  - `chapter` 和 `section` 的 `name` 字段仅用于目录展示，不会出现在正文展示中
  - `section` 的 `path` 字段通过相对路径引用具体的 `.md` 文件，具体目录结构和位置可由作者自行组织

### 正文文件

一组由作者组织和命名的 Markdown 格式（`.md`）文本文件，其相对路径可由 `toc.yaml` 文件自行定制。

这些文件的内容遵循本标准定义的格式，这是一种基于 Markdown 标准扩展的文本格式，详见下面相关章节描述。

### 附加资源文件

在正文中用到的各种附加资源文件（图片、音频/视频文件、数据文件等），置于 `assets` 子目录下，此目录下可以依作者的设计建立子目录，正文中使用正确的相对路径引用相应资源文件即可。

正文中包含的可运行程序代码也可以使用这些附加资源文件。

## 基于 Markdown 标准扩展的文本格式

- 支持所有 Markdown 标准元素；
- 兼容 CommonMark 的扩展元素。

### 可扩展的自定义标签

采用 HTML 注释语法定义自定义标签（*SBS tags*），来实现特殊的扩展功能。

```markdown
<!-- sbs-tagname:n1="v1",n2="v2",...  -->
```

将如上代码置于 Markdown 文本中，或者希望约束/修饰的 Markdown 元素之前，可以实现特殊的渲染效果或交互功能，其中：
- 整个标签置于 HTML 注释语法 `<!--  -->` 内，确保向下兼容；
- 最开始的标签名须以 `sbs-` 开始，避免名字空间冲突，也便于追踪和处理；
- 标签名之后是英文冒号和可选的1或多个参数，如果没有参数则冒号可以省略；
- 每个参数由 `name="value"` 格式表达，多个参数之间以英文逗号隔开，如果 `value` 内仅包含数字或英文字母则引号可以省略；
- 如果是自渲染的自定义标签则可置于需要的任何位置，如果是修饰性（指改变原内容渲染或交互逻辑）的自定义标签则需要置于紧靠被修饰元素之前的独立一行。

下面是 SBS-1.0 内建支持的自定义标签。

#### 可在线编辑/运行的代码片段

```markdown
<!-- sbs-code -->
```

置于 Markdown 标准的代码块元素之前即可，例如：

````markdown
<!-- sbs-code -->
```python
println("Hello world!")
```
````

#### 图片对齐与缩放

```markdown
<!-- sbs-image:align=,scale=,width=,height= -->
```

置于 Markdown 图片元素之前即可，例如：

```markdown
<!-- sbs-image:align=,scale=,width=,height= -->
![beautiful pic](https://images.com/pic.jpg)
```

`sbs-image` 支持一组参数（均为可选，但至少要指定其一）：
- `align`：图片对齐，可以取值 `left` `center` `right`，分别实现图片的靠左、居中和靠右对齐；
- `scale`：图片缩放比例，可以取大于 0 的浮点数值，为图片显示的缩放比率；
- `width`, `height`：指定图片显示的宽和高像素（*pixel*）值，可以取大于0的整数值，注意：
  - 如果前面指定了 `scale` 参数，此二参数会被忽略；
  - 如果只指定了此二参数之一，图片会按指定的宽或高以及图片原始宽高比缩放显示；
  - 如果同时指定了此二参数，图片会按指定的宽和高像素值显示，而忽略图片的原宽高比。
